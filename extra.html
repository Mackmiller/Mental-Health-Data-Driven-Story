<div id="d3id" ></div>
<script>
var models = [
  {
    "model_name":"2003",
    "field1":996,
    "field2":447.6,
    "field3":1008.9,
    "field4":532.8,
    "field5":921
  },
  {
    "model_name":"2004",
    "field1":1030.1,
    "field2":598.4,
    "field3":1014.3,
    "field4":929.6,
    "field5":965.3
  },
  {
    "model_name":"2005",
    "field1":1028.3,
    "field2":512.4,
    "field3":906.9,
    "field4":1038.1,
    "field5":996.1
  },

];
models = models.map(i => {
  i.model_name = i.model_name;
	return i;
});

var container = d3.select('#d3id'),
    width = 800,
    height = 500,
    margin = {top: 30, right: 20, bottom: 30, left: 50},
    barPadding = .2,
    axisTicks = {qty: 5, outerSize: 0};

var svg = container
   .append("svg")
   .attr("width", width)
   .attr("height", height)
   .append("g")
   .attr("transform", `translate(${margin.left},${margin.top})`);

var xScale0 = d3.scaleBand().range([0, width - margin.left - margin.right]).padding(barPadding);
var xScale1 = d3.scaleBand();
var yScale = d3.scaleLinear().range([height - margin.top - margin.bottom, 0]);

var xAxis = d3.axisBottom(xScale0).tickSizeOuter(axisTicks.outerSize);
var yAxis = d3.axisLeft(yScale).ticks(axisTicks.qty).tickSizeOuter(axisTicks.outerSize);

xScale0.domain(models.map(d => d.model_name));
xScale1.domain(['field1', 'field2', 'field3', "field4", "field5"]).range([0, xScale0.bandwidth()]);
yScale.domain([0, 1200]);

var model_name = svg.selectAll(".model_name")
  .data(models)
  .enter().append("g")
  .attr("class", "model_name")
  .attr("transform", d => `translate(${xScale0(d.model_name)},0)`);

/* Add field1 bars */
model_name.selectAll(".bar.field1")
  .data(d => [d])
  .enter()
  .append("rect")
  .attr("class", "bar field1")
.style("fill","#5FA5A5")
  .attr("x", d => xScale1('field1'))
  .attr("y", d => yScale(d.field1))
  .attr("width", xScale1.bandwidth())
  .attr("height", d => {
    return height - margin.top - margin.bottom - yScale(d.field1)
  });

/* Add field2 bars */
model_name.selectAll(".bar.field2")
  .data(d => [d])
  .enter()
  .append("rect")
  .attr("class", "bar field2")
.style("fill","#CCBE49")
  .attr("x", d => xScale1('field2'))
  .attr("y", d => yScale(d.field2))
  .attr("width", xScale1.bandwidth())
  .attr("height", d => {
    return height - margin.top - margin.bottom - yScale(d.field2)
  });

/* Add field3 bars */
  model_name.selectAll(".bar.field3")
    .data(d => [d])
    .enter()
    .append("rect")
    .attr("class", "bar field3")
  .style("fill","#E17B45")
    .attr("x", d => xScale1('field3'))
    .attr("y", d => yScale(d.field3))
    .attr("width", xScale1.bandwidth())
    .attr("height", d => {
      return height - margin.top - margin.bottom - yScale(d.field3)
    });

    /* Add field4 bars */
      model_name.selectAll(".bar.field4")
        .data(d => [d])
        .enter()
        .append("rect")
        .attr("class", "bar field4")
      .style("fill","#DC3C75")
        .attr("x", d => xScale1('field4'))
        .attr("y", d => yScale(d.field4))
        .attr("width", xScale1.bandwidth())
        .attr("height", d => {
          return height - margin.top - margin.bottom - yScale(d.field4)
        });
        /* Add field5 bars */
          model_name.selectAll(".bar.field5")
            .data(d => [d])
            .enter()
            .append("rect")
            .attr("class", "bar field5")
          .style("fill","#392D37")
            .attr("x", d => xScale1('field5'))
            .attr("y", d => yScale(d.field5))
            .attr("width", xScale1.bandwidth())
            .attr("height", d => {
              return height - margin.top - margin.bottom - yScale(d.field5)
            });


// Add the X Axis
svg.append("g")
   .attr("class", "x axis")
   .attr("transform", `translate(0,${height - margin.top - margin.bottom})`)
   .call(xAxis);

// Add the Y Axis
svg.append("g")
   .attr("class", "y axis")
   .call(yAxis);

   svg.append("g")
     .attr("class", "y axis")
     .call(yAxis)
     .append('text')
     .attr("y", -43)
     .attr("x", -120)
     .attr("transform", "rotate(-90)")
     .attr("fill", "#000")
     .text("Number hospitalized per 100,000 people");
//legend
svg.append("g")

  .append('text')
  .attr("y", 67)
  .attr("x", -425)
  .attr("transform", "rotate(-90)")
  .attr("fill", "white")
  .text("Broward County");

  svg.append("g")

    .append('text')
    .attr("y", 107)
    .attr("x", -425)
    .attr("transform", "rotate(-90)")
    .attr("fill", "white")
    .text("Charlotte County");

    svg.append("g")

      .append('text')
      .attr("y", 144)
      .attr("x", -425)
      .attr("transform", "rotate(-90)")
      .attr("fill", "white")
      .text("Escambia County");

      svg.append("g")

        .append('text')
        .attr("y", 181)
        .attr("x", -425)
        .attr("transform", "rotate(-90)")
        .attr("fill", "white")
        .text("Broward County");

        svg.append("g")

          .append('text')
          .attr("y", 215)
          .attr("x", -425)
          .attr("transform", "rotate(-90)")
          .attr("fill", "white")
          .text("Palm Beach");

</script>
<script>
var models = [
  {
    "model_name":"2003",
    "field1":996,
    "field2":447.6,
    "field3":1008.9,
    "field4":532.8,
    "field5":921
  },
  {
    "model_name":"2004",
    "field1":1030.1,
    "field2":598.4,
    "field3":1014.3,
    "field4":929.6,
    "field5":965.3
  },
  {
    "model_name":"2005",
    "field1":1028.3,
    "field2":512.4,
    "field3":906.9,
    "field4":1038.1,
    "field5":996.1
  },

];
models = models.map(i => {
  i.model_name = i.model_name;
	return i;
});

var container = d3.select('#d3id'),
    width = 800,
    height = 500,
    margin = {top: 30, right: 20, bottom: 30, left: 50},
    barPadding = .2,
    axisTicks = {qty: 5, outerSize: 0};

var svg = container
   .append("svg")
   .attr("width", width)
   .attr("height", height)
   .append("g")
   .attr("transform", `translate(${margin.left},${margin.top})`);

var xScale0 = d3.scaleBand().range([0, width - margin.left - margin.right]).padding(barPadding);
var xScale1 = d3.scaleBand();
var yScale = d3.scaleLinear().range([height - margin.top - margin.bottom, 0]);

var xAxis = d3.axisBottom(xScale0).tickSizeOuter(axisTicks.outerSize);
var yAxis = d3.axisLeft(yScale).ticks(axisTicks.qty).tickSizeOuter(axisTicks.outerSize);

xScale0.domain(models.map(d => d.model_name));
xScale1.domain(['field1', 'field2', 'field3', "field4", "field5"]).range([0, xScale0.bandwidth()]);
yScale.domain([0, 1200]);

var model_name = svg.selectAll(".model_name")
  .data(models)
  .enter().append("g")
  .attr("class", "model_name")
  .attr("transform", d => `translate(${xScale0(d.model_name)},0)`);

/* Add field1 bars */
model_name.selectAll(".bar.field1")
  .data(d => [d])
  .enter()
  .append("rect")
  .attr("class", "bar field1")
.style("fill","#5FA5A5")
  .attr("x", d => xScale1('field1'))
  .attr("y", d => yScale(d.field1))
  .attr("width", xScale1.bandwidth())
  .attr("height", d => {
    return height - margin.top - margin.bottom - yScale(d.field1)
  });

/* Add field2 bars */
model_name.selectAll(".bar.field2")
  .data(d => [d])
  .enter()
  .append("rect")
  .attr("class", "bar field2")
.style("fill","#CCBE49")
  .attr("x", d => xScale1('field2'))
  .attr("y", d => yScale(d.field2))
  .attr("width", xScale1.bandwidth())
  .attr("height", d => {
    return height - margin.top - margin.bottom - yScale(d.field2)
  });

/* Add field3 bars */
  model_name.selectAll(".bar.field3")
    .data(d => [d])
    .enter()
    .append("rect")
    .attr("class", "bar field3")
  .style("fill","#E17B45")
    .attr("x", d => xScale1('field3'))
    .attr("y", d => yScale(d.field3))
    .attr("width", xScale1.bandwidth())
    .attr("height", d => {
      return height - margin.top - margin.bottom - yScale(d.field3)
    });

    /* Add field4 bars */
      model_name.selectAll(".bar.field4")
        .data(d => [d])
        .enter()
        .append("rect")
        .attr("class", "bar field4")
      .style("fill","#DC3C75")
        .attr("x", d => xScale1('field4'))
        .attr("y", d => yScale(d.field4))
        .attr("width", xScale1.bandwidth())
        .attr("height", d => {
          return height - margin.top - margin.bottom - yScale(d.field4)
        });
        /* Add field5 bars */
          model_name.selectAll(".bar.field5")
            .data(d => [d])
            .enter()
            .append("rect")
            .attr("class", "bar field5")
          .style("fill","#392D37")
            .attr("x", d => xScale1('field5'))
            .attr("y", d => yScale(d.field5))
            .attr("width", xScale1.bandwidth())
            .attr("height", d => {
              return height - margin.top - margin.bottom - yScale(d.field5)
            });


// Add the X Axis
svg.append("g")
   .attr("class", "x axis")
   .attr("transform", `translate(0,${height - margin.top - margin.bottom})`)
   .call(xAxis);

// Add the Y Axis
svg.append("g")
   .attr("class", "y axis")
   .call(yAxis);

   svg.append("g")
     .attr("class", "y axis")
     .call(yAxis)
     .append('text')
     .attr("y", -43)
     .attr("x", -120)
     .attr("transform", "rotate(-90)")
     .attr("fill", "#000")
     .text("Number hospitalized per 100,000 people");
//legend
svg.append("g")

  .append('text')
  .attr("y", 67)
  .attr("x", -425)
  .attr("transform", "rotate(-90)")
  .attr("fill", "white")
  .text("Broward County");

  svg.append("g")

    .append('text')
    .attr("y", 107)
    .attr("x", -425)
    .attr("transform", "rotate(-90)")
    .attr("fill", "white")
    .text("Charlotte County");

    svg.append("g")

      .append('text')
      .attr("y", 144)
      .attr("x", -425)
      .attr("transform", "rotate(-90)")
      .attr("fill", "white")
      .text("Escambia County");

      svg.append("g")

        .append('text')
        .attr("y", 181)
        .attr("x", -425)
        .attr("transform", "rotate(-90)")
        .attr("fill", "white")
        .text("Broward County");

        svg.append("g")

          .append('text')
          .attr("y", 215)
          .attr("x", -425)
          .attr("transform", "rotate(-90)")
          .attr("fill", "white")
          .text("Palm Beach");

</script>
